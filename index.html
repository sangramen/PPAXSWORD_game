<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>sÌµÌ®Í‡Í‚ÌƒaÌ¶Ì¯Ì®Ì£ÌÍ’Ì‹Å†Ä¡_Å™?Ä…ì˜ ì†Œë“œ ê°•í™” ê²Œì„</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      margin-top: 30px;
    }

    #gameArea,
    #rankingBox {
      display: none;
    }

    #intro {
      margin-top: 100px;
    }

    #intro button {
      font-size: 32px;
      padding: 24px 60px;
      margin-top: 30px;
      cursor: pointer;
    }

    #shopButton {
      position: fixed;
      top: 48px;
      left: 10px;
      background-color: #28a745;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 52px;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      display: none;
      z-index: 999;
    }

    #shopArea {
      display: none;
      margin-top: 50px;
    }

    button {
      cursor: pointer;
    }

    img {
      margin: 20px;
      max-width: 90%;
      height: auto;
    }

    #buyProtectBtn {
      font-size: 20px;
      padding: 12px 30px;
      margin-top: 20px;
      cursor: pointer;
    }

    .gameControl {
      display: none;
      font-size: 18px;
      padding: 10px 20px;
    }

    #infoBox {
      display: none;
      position: absolute;
      top: 60px;
      right: 50px;
      width: 320px;
      height: 420px;
      border: 2px solid #333;
      border-radius: 8px;
      padding: 15px;
      font-size: 20px;
      text-align: left;
      background: #f7f7f7;
      box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
    }

    @media (max-width: 768px) {
      body {
        font-size: 16px;
      }

      #infoBox {
        position: static;
        width: 90%;
        margin: 20px auto;
        height: auto;
      }

      #shopButton {
        font-size: 36px;
        padding: 10px 20px;
      }

      #intro button {
        font-size: 24px;
        padding: 16px 40px;
      }

      .gameControl {
        font-size: 16px;
        padding: 10px 15px;
      }
    }
  </style>
</head>

<body>
  <div id="intro">
    <h1>ì†Œë“œ ê°•í™” ì‹œë®¬ë ˆì´í„° by.sÌµÌ®Í‡Í‚ÌƒaÌ¶Ì¯Ì®Ì£ÌÍ’Ì‹Å†Ä¡_Å™?Ä…</h1>
    <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
  </div>

  <button id="shopButton" onclick="openShop()">ìƒì </button>

  <div id="gameArea">
    <h2>í™˜ì˜í•©ë‹ˆë‹¤, <span id="nicknameDisplay"></span> ë‹˜!</h2>
    <img id="swordImg" src="sword_lv0.png" width="200"><br>
    <p id="swordName">ê²€ ì´ë¦„: ì°Œê·¸ëŸ¬ì§„ ì†Œë“œ.</p>
    <p>í˜„ì¬ ë ˆë²¨: <span id="currentLevel">0</span></p>
    <p>í……ì¥(ì†Œì§€ê¸ˆ): <span id="money">0</span> ì›</p>
    <p>ê°•í™”ë¹„ìš©: <span id="enhanceCost">100</span> ì›</p>
    <button class="gameControl" onclick="enhanceSword()">ê°•í™”!!!</button>
    <button class="gameControl" onclick="sellSword()">ì†Œ@ë“œ íŒë§¤í•˜ê¸°(?)</button>

    <p style="margin-top: 10px; font-weight: bold;">
      PPAXì™€ AgAëŠ” ìµœê°•ì´ë‹¤<br>
    </p>
    <h3>ğŸ†ë­í‚¹ğŸ†</h3>
    <pre id="rankingBox"></pre>
  </div>

  <div id="infoBox">
    <p style="font-weight: bold; font-size: 22px; margin-bottom: 8px;">ê°•í™” ì„±ê³µ í™•ë¥ </p>
    <p id="successRateDisplay" style="font-size: 28px; margin: 0 0 12px 0;">100%</p>
    <hr style="margin: 8px 0;" />
    <p>í˜„ì¬ ì†Œë“œ íŒë§¤ ê°€ê²©: <span id="currentPriceDisplay">0 ì›</span></p>
    <p>ë‹¤ìŒ ë ˆë²¨ íŒë§¤ ê°€ê²©: <span id="nextPriceDisplay">0 ì›</span></p>
    <hr style="margin: 12px 0;" />
    <p>í˜„ì¬ ë ˆë²¨: <span id="currentLevelInfo">0</span></p>
    <p>í……ì¥(ì†Œì§€ê¸ˆ): <span id="moneyInfo">0</span> ì›</p>
    <p id="protectStatus">ê°•í™” ë³´í˜¸ ì•„ì´í…œ: ì—†ìŒ</p>
  </div>

  <div id="shopArea">
    <h2>ìƒì </h2>
    <button id="buyProtectBtn" onclick="buyProtectItem()">87ì„¸ ê¹€ë¯¸ì‹œ í• ë¨¸ë‹ˆì˜ ìµœí›„ì˜ ê°‘ì˜· êµ¬ë§¤ (3000ì›)</button><br />
    <button onclick="closeShop()" style="margin-top: 20px;">ìƒì  ë‚˜ê°€ê¸°</button>
  </div>

</body>

<!-- íš¨ê³¼ìŒ -->
<audio id="successSound" src="success.mp3"></audio>
<audio id="failSound" src="fail.mp3"></audio>
<audio id="enhanceTrySound" src="enhanceTry.mp3"></audio>
<audio id="buyProtectSound" src="buyProtect.mp3"></audio>
<audio id="sellSound" src="sell.mp3"></audio>

<!-- ì´ˆê¸°í™” ë²„íŠ¼ -->
<button id="resetButton" onclick="openResetWindow()" style="
  position: fixed;
  top: 80px; /* ìƒì  ë²„íŠ¼ ì•„ë˜ */
  left: 10px;
  background-color: #dc3545;
  color: white;
  border: none;
  padding: 15px 30px;
  font-size: 48px;
  font-weight: bold;
  border-radius: 6px;
  cursor: pointer;
  z-index: 999;
  display: none;
">ë°ì´í„°_ì´ˆê¸°í™”.exe</button>

<script>
  let level = 0;
  let nickname = '';
  let highScore = 0;
  let workspace = 'true_dev'
  let money = 2500;
  let protectItem = false;

  // í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ ì´ì „ì— ì‚¬ìš©í–ˆë˜ ë‹‰ë„¤ì„ì´ ìˆë‹¤ë©´ ìë™ ë¶ˆëŸ¬ì˜¤ê¸°
  window.addEventListener('DOMContentLoaded', () => {
    const lastNickname = localStorage.getItem('lastNickname');
    if (lastNickname && localStorage.getItem(lastNickname)) {
      const shouldLoad = confirm(`${lastNickname} ë‹˜ì˜ ì €ì¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ê¹Œìš”?`);
      if (shouldLoad) {
        nickname = lastNickname;
        const saved = JSON.parse(localStorage.getItem(nickname));
        level = saved.level;
        money = saved.money;
        protectItem = saved.protectItem;
        highScore = saved.highScore || level;

        document.getElementById('nicknameDisplay').textContent = nickname;
        document.getElementById('intro').style.display = 'none';
        document.getElementById('gameArea').style.display = 'block';
        document.getElementById('shopButton').style.display = 'block';
        document.getElementById('infoBox').style.display = 'block';

        document.querySelectorAll('.gameControl').forEach(btn => {
          btn.style.display = 'inline-block';
        });

        updateUI();
        showRanking();
      }
    }
  });


  const successRates = [1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1, 0.05, 0.025, 0.0001];
  const swordNames = [
    "ì°Œê·¸ëŸ¬ì§„ ì†Œë“œ.",
    "ëª©ê²€ ì†Œë“œ",
    "ì •ìƒì ì¸ ì†Œë“œ",
    "ì§±ìˆ ì†Œë“œ",
    "ì‚¬ì¶˜ê¸° ì†Œë“œ",
    "ì¹´ì´ë‹¤ ì†Œë“œ",
    "PRETTY ì†Œë“œ",
    "ë‚œìŸì´ ì†Œë“œ",
    "ì„íƒ„ ì½”ìŠ¤í”„ë ˆí•˜ëŠ” ì†Œë“œ",
    "ê°œë°œì ë¨¹ëŠ” ì†Œë“œ",
    "ë¹„ë‘˜ê¸° ì†Œë“œ",
    "ë‚œìŸì´ëª©ê²€ ì†Œë“œ",
    "íƒˆëª¨ì˜¨ ì†Œë“œ"
  ];

  const bannedWords = ["ã…ˆã…ˆ", "ã…‚ã……", "ìš´ì§€", "ì”¨", "êº¼ì ¸", "ë³‘ì‹ ", "ë…¸ë¬´í˜„", "ë‹¤ì´ë¹™", "ë‹ˆì—„ë§ˆ", "ì£½ìŒ"];

  function getEnhanceCost(level) {
    return Math.floor(100 * Math.pow(1.25, level));
  }

  function isSuccess() {
    const rate = successRates[level] ?? 0.1;
    return Math.random() < rate;
  }

  function updateUI() {
    // ê°•í™” ì„±ê³µ í™•ë¥ 
    const successRate = successRates[level] ?? 0.1;
    document.getElementById('successRateDisplay').textContent = `${(successRate * 100).toFixed(1)}%`;

    // íŒë§¤ ê°€ê²© í‘œì‹œ
    document.getElementById('currentPriceDisplay').textContent = `${getSellPrice(level)} ì›`;
    document.getElementById('nextPriceDisplay').textContent = `${getSellPrice(level + 1)} ì›`;

    // infoBox ë‚´ í˜„ì¬ ë ˆë²¨, ì†Œì§€ê¸ˆ í‘œì‹œ (ë³„ë„ì˜ id ì‚¬ìš©)
    document.getElementById('currentLevelInfo').textContent = level;
    document.getElementById('moneyInfo').textContent = money;

    // ë³´í˜¸ ì•„ì´í…œ ìƒíƒœ í‘œì‹œ
    document.getElementById('protectStatus').textContent = protectItem ? "ê°•í™” ë³´í˜¸ ì•„ì´í…œ: ì¥ì°© ì¤‘" : "ê°•í™” ë³´í˜¸ ì•„ì´í…œ: ì—†ìŒ";

    // ê¸°ì¡´ gameArea UI ì—…ë°ì´íŠ¸
    document.getElementById('currentLevel').textContent = level;
    document.getElementById('money').textContent = money;
    document.getElementById('swordImg').src = `sword_lv${Math.min(level, 13)}.png`;
    document.getElementById('swordName').textContent = `ê²€ ì´ë¦„: ${swordNames[Math.min(level, 12)]}`;
    document.getElementById('enhanceCost').textContent = getEnhanceCost(level);
  }

  function startGame() {
    nickname = prompt('ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”~~ (ìµœëŒ€ 30ì)');
    if (!nickname || nickname.length > 30) {
      alert("ë‹‰ë„¤ì„ì€ 30ì ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.");
      return;
    }
    if (bannedWords.some(bad => nickname.includes(bad))) {
      alert("ë¶€ì ì ˆí•œ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤.");
      return;
    }
    localStorage.setItem('lastNickname', nickname);


    const ranking = JSON.parse(localStorage.getItem('ranking') || '[]');
    const allKeys = Object.keys(localStorage);
    const nicknameExists = allKeys.includes(nickname);
    if (ranking.some(r => r.nickname === nickname) || nicknameExists) {
      alert("ì´ë¯¸ ëˆ„ê°€ ê°€ì ¸ê°„ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤ ã…‹ ë‹¤ë¥¸ê±° ê³ ë¥´ì„¸ìš”.");
      return;
    }

    // ë‹‰ë„¤ì„ í†µê³¼í•˜ë©´ UI ì´ˆê¸°í™” ë° ë³´ì´ê¸°
    document.getElementById('nicknameDisplay').textContent = nickname;
    document.getElementById('intro').style.display = 'none';
    document.getElementById('gameArea').style.display = 'block';
    document.getElementById('shopButton').style.display = 'block';
    document.getElementById('infoBox').style.display = 'block';

    // ê²Œì„ ì»¨íŠ¸ë¡¤ ë²„íŠ¼ë“¤ í‘œì‹œ
    document.querySelectorAll('.gameControl').forEach(btn => {
      btn.style.display = 'inline-block';
    });

    const saved = JSON.parse(localStorage.getItem(nickname));
    if (saved) {
      level = saved.level;
      money = saved.money;
      protectItem = saved.protectItem;
      highScore = saved.highScore || level;
    }
    updateUI();
    showRanking();
  }

  function openShop() {
    document.getElementById('gameArea').style.display = 'none';
    document.getElementById('rankingBox').style.display = 'none';
    document.getElementById('shopArea').style.display = 'block';
    document.getElementById('shopButton').style.display = 'none';
  }

  function closeShop() {
    document.getElementById('shopArea').style.display = 'none';
    document.getElementById('gameArea').style.display = 'block';
    document.getElementById('rankingBox').style.display = 'block';
    document.getElementById('shopButton').style.display = 'block';
    updateUI();
  }

  function buyProtectItem() {
    if (money < 3000) return alert("3000ì›ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.");
    money -= 3000;
    protectItem = true;
    alert("87ì„¸ ê¹€ë¯¸ì‹œ í• ë¨¸ë‹ˆì˜ ìµœí›„ì˜ ê°‘ì˜·ì„ êµ¬ë§¤í•˜ì—¬ ì¥ì°©í–ˆìŠµë‹ˆë‹¤.");
    playBuyProtectSound();
    savePlayerState();
    updateUI();
  }

  function playBuyProtectSound() {
    const sound = document.getElementById('buyProtectSound');
    if (sound) {
      sound.currentTime = 0;
      sound.play();
    }
  }

  function playEnhanceTrySound() {
    const trySound = document.getElementById('enhanceTrySound');
    if (trySound) {
      trySound.currentTime = 0;
      trySound.play();
    }
  }

  function enhanceSword() {
    playEnhanceTrySound();
    const cost = getEnhanceCost(level);
    if (money < cost) return alert(`ê°•í™”ë¹„ìš© ${cost}ì›ì´ í•„ìš”í•©ë‹ˆë‹¤.`);
    money -= cost;

    if (isSuccess()) {
      level++;
      if (level > highScore) {
        highScore = level;
        saveHighScore();
      }
      alert(`ì„±ê³µ! ì†Œë“œ ë ˆë²¨: +${level}`);
      playSound(true);
    } else {
      if (protectItem) {
        protectItem = false;
        alert("ì‹¤íŒ¨! but '87ì„¸ ê¹€ë¯¸ì‹œ í• ë¨¸ë‹ˆì˜ ìµœí›„ì˜ ê°‘ì˜·' ë•ë¶„ì— íŒŒê´´ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
      } else {
        level = 0;
        alert("ì‹¤íŒ¨! ì†Œë“œê°€ BROKEN!!!");
      }
      playSound(false);
    }
    updateUI();
    savePlayerState();
    showRanking();
  }

  function playSellSound() {
    const audio = document.getElementById('sellSound');
    if (audio) {
      audio.currentTime = 0;
      audio.play();
    }
  }

  function sellSword() {
    if (level < 1) return alert("ë ˆë²¨ 0 ì†Œë“œëŠ” íŒë§¤í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    const price = getSellPrice(level);
    money += price;
    level = 0;
    alert(`ã„·ê·¼ë§ˆcatì— ì†Œë“œë¥¼ íŒ”ì•„ì„œ ${price}ì›ì„ íšë“í–ˆìŠµë‹ˆë‹¤!! ã…‹ã…‹ã…‹ã…‹`);
    playSellSound();
    updateUI();
    savePlayerState();
  }

  function getSellPrice(level) {
    if (level === 1) return 100;
    if (level === 2) return 250;
    if (level === 3) return 1000;
    let price = 1000;
    for (let i = 4; i <= level; i++) price *= 2;
    return price;
  }

  function saveHighScore() {
    let ranking = JSON.parse(localStorage.getItem('ranking') || '[]');
    const existing = ranking.find(r => r.nickname === nickname);
    if (existing) {
      existing.score = Math.max(existing.score, highScore);
    } else {
      ranking.push({ nickname, score: highScore });
    }
    ranking.sort((a, b) => b.score - a.score);
    localStorage.setItem('ranking', JSON.stringify(ranking.slice(0, 10)));
  }

  function savePlayerState() {
    localStorage.setItem(nickname, JSON.stringify({ level, money, protectItem, highScore }));
  }

  function showRanking() {
    const ranking = JSON.parse(localStorage.getItem('ranking') || '[]');
    const list = ranking.map((r, i) => `${i + 1}. ${r.nickname}: +${r.score}`).join('\n');
    document.getElementById('rankingBox').textContent = list;
    document.getElementById('rankingBox').style.display = 'block';
  }

  function playSound(success) {
    const audio = document.getElementById(success ? 'successSound' : 'failSound');
    audio.currentTime = 0;
    audio.play();
  }

  // ê°œë°œì ì „ìš© ì¹˜íŠ¸í‚¤: Shift + Ctrl + R + ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í›„ ì´ˆê¸°í™”
  document.addEventListener('keydown', e => {
    if (e.shiftKey && e.ctrlKey && e.code === 'KeyR') {
      const password = prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
      if (password === workspace) {
        if (confirm("[DEV] ë­í‚¹ ë° ì €ì¥ëœ ë‹‰ë„¤ì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤. ê³„ì†í• ê¹Œìš”?")) {
          localStorage.clear();
          alert("ì´ˆê¸°í™” ì™„ë£Œë¨. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.");
          location.reload();
        }
      } else {
        alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
      }
    }
  });
</script>
</body>

</html>